/* REXX */
/* EXEC FOR CHANGE DSKLST AFTER REFORMAT (IF SAFE DELETE ENABLED)*/
/* RSOLVING UNIT ADDRESS (IF SAFE DELETE DISABLED)*/
CALL ISPPRXVP 'I'
STAT = ''
IF ISFCALLS('ON') <> 0 THEN EXIT 99
IF Q <> '/' THEN DO
CALL GETADDR# VOL
IF RESULT <> '' THEN DO
  ADDR = RESULT
  STAT = 'OK'
END
ELSE
  STAT =''
END
ELSE DO
  "ALLOC DA('"DSKLST"') F(INPUTDD) SHR REUSE"
  "EXECIO * DISKR INPUTDD (STEM DSKL. FINIS"
  "FREE F(INPUTDD)"
  /* SPLITTING STRINGS TO ADDR */
  TMPVOL=''
  TMPADDR=''
  DO I=2 TO DSKL.0 WHILE TMPVOL/='******'
    TMPVOL = SUBSTR(DSKL.I,10,6)
    TMPADDR = SUBSTR(DSKL.I,1,4)
    IF (VOL = TMPVOL) THEN DO
      ADDR = SUBSTR(DSKL.I,1,4)
      IF OPER <> 'DEL' THEN
      TMPVOL = 'TM'ADDR
      SIZE = SUBSTR(DSKL.I,19,2)
      /* SAY 'ADDR 'ADDR' VOL: ' VOL */
      DSKL.I=ADDR'     'TMPVOL'   'SIZE
      STAT='OK'
      LEAVE
    END
    IF (ADDR = TMPADDR & OPER = 'DEL') THEN DO
    TMPVOL = VOL
    SIZE = SUBSTR(DSKL.I,19,2)
    DSKL.I=ADDR'     'TMPVOL'   'SIZE
    STAT='OK'
    LEAVE
    END
  END
  "ALLOC DA('"DSKLST"') F(OUTDD) SHR REUSE"
  "EXECIO * DISKW OUTDD (STEM DSKL. FINIS"
  "FREE F(OUTDD)"
END
CALL ISFCALLS 'OFF'
CALL ISPPRXVP 'T'
EXIT 0
